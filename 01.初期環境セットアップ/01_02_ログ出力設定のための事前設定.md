# ログ出力設定のための事前設定

LAW に収集するログとして特に重要なものとして、以下の 2 つがあります。

- アクティビティログ
  - 各サブスクリプションに対して実施されたリソース操作に関するログです。
- リソース診断ログ
  - 各リソースから出力されるイベントログや性能ログです。

これらのログ設定のうち、特に各リソースに対して行うリソース診断ログの設定はリソース作成のつど行う必要があり、比較的設定漏れが発生しやすいという問題があります。このため本デモでは、「サブスクリプションのアクティビティログの出力を設定する」「サブスクリプション内に存在するすべてのリソースを検索し、事前に定義されたリソースタイプに対して自動的にリソース診断ログ出力を設定する」という汎用的なスクリプトを用意しました。これらのスクリプトは、"TEMP_TARGET_SUBSCRIPTION_IDS" 変数に格納されている各サブスクリプションに対して、自動的にログ出力を設定する、という形で作られています。他のセクションでも設定スクリプトを何度も再利用しますのでご注意ください。

ここではまず、管理サブスクリプションとハブサブスクリプションの 2 つについて、ログ出力設定を行います。以下の設定を行ったうえで、次のページに用意している以下 2 つの処理を流してください。

- ★ アクティビティログの出力設定
- ★ リソース診断ログ出力の一括設定

```bash
# 基盤サブスクリプションだけ対象にする
TEMP_TARGET_SUBSCRIPTION_IDS="$SUBSCRIPTION_ID_HUB  $SUBSCRIPTION_ID_MGMT"
```

または最初からすべてのサブスクリプションを対象にアクティビティログを設定しても構いません。その場合は以下の設定で進めてください。

```bash
# すべてのサブスクリプションを対象にする
TEMP_TARGET_SUBSCRIPTION_IDS=$SUBSCRIPTION_IDS
```
